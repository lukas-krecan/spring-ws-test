<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at May 8, 2013 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Functional tests</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20130508" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href="./" id="bannerLeft">
                Spring WS Test
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2013-05-08</span>
                  &nbsp;| <span id="projectVersion">Version: 0.23-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href="http://static.springsource.org/spring-ws/sites/1.5/" class="externalLink" title="Spring WS">Spring WS</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Spring WS Test</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="client-tutorial.html" title="Client Test Tutorial">Client Test Tutorial</a>
            </li>
                  <li class="none">
                          <a href="unit-test-support.html" title="Advanced Client Unit Tests">Advanced Client Unit Tests</a>
            </li>
                  <li class="none">
                          <a href="server-test-support.html" title="Server test support">Server test support</a>
            </li>
                  <li class="none">
            <strong>Functional tests</strong>
          </li>
                  <li class="none">
                          <a href="download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="reference.html" title="Reference">Reference</a>
            </li>
                  <li class="none">
                          <a href="naq.html" title="N.A.Q">N.A.Q</a>
            </li>
                  <li class="none">
                          <a href="sample.html" title="Sample app">Sample app</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                   <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!--  --><!-- Copyright 2009-2010 the original author or authors. --><!--  --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!--  --><!--  --><!-- Copyright 2006 the original author or authors. --><!--  --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!--  --><div class="section"><h2>Functional tests<a name="Functional_tests"></a></h2><p>In this tutorial we will cover support for functional tests. By a functional test we mean a test, that is not executed by a Java code but by hand, by a tool like Selenium or by some other tool. In such cases, it's not possible to use our <a href="#unit-test-support.html">unit test</a> support. We need something more similar to a mock server.</p><p>So let's say that we have our code finished and it generates the following request. </p><div><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
        &lt;SOAP-ENV:Header /&gt;
        &lt;SOAP-ENV:Body&gt;
                &lt;ns3:GetFlightsRequest
                        xmlns:ns2=&quot;http://www.springframework.org/spring-ws/samples/airline/schemas/types&quot;
                        xmlns:ns3=&quot;http://www.springframework.org/spring-ws/samples/airline/schemas/messages&quot;&gt;
                        &lt;ns3:from&gt;PRG&lt;/ns3:from&gt;
                        &lt;ns3:to&gt;DUB&lt;/ns3:to&gt;
                        &lt;ns3:departureDate&gt;2009-10-31+01:00&lt;/ns3:departureDate&gt;
                        &lt;ns3:serviceClass&gt;economy&lt;/ns3:serviceClass&gt;
                &lt;/ns3:GetFlightsRequest&gt;
        &lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;</pre></div><p>We need to configure the application so the request is validated and a mock response is returned.</p><div class="section"><h3>Mock response structure<a name="Mock_response_structure"></a></h3><p>We can start by creating mock responses. To do this we have to create a special directory structure in our classpath. If you are using Maven, the ideal place to create it is in <tt>src/test/resources</tt>. Default directory name where mock responses are looked for is &quot;mock-xml/<i>payloadRootName</i>&quot;. For example, if your WS message payload root element is called &quot;GetFlightsRequest&quot;, resources from &quot;mock-xml/GetFlightsRequest&quot; are used.</p><p>&quot;response.xml&quot; file is used as template for generating response, if not specified otherwise.</p><p>Of course, only one mock response per service is not sufficient. It is usually needed to define more response files. To be able to do this, it has to be defined a way how to decide which file will be used. By default XPath discriminators are used. For example, if &quot;//ns:from;//ns:to&quot; is used as discriminators for given service and our sample request is used, content of &quot;mock-xml/GetFlightsRequest/PRG-DUB-response.xml&quot; will be returned as a mock response. If this file is not found &quot;mock-xml/GetFlightsRequest/PRG-response.xml&quot; will be used and if even that file is not found, default response will be returned.</p></div><div class="section"><h3>Configuration file <a name="Configuration_file"></a></h3><p>Usual configuration will look like the following example.</p><div><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
        xmlns:swst=&quot;http://javacrumbs.net/schema/1.0/spring-ws-test&quot;
        xmlns:util=&quot;http://www.springframework.org/schema/util&quot;
        xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
                http://javacrumbs.net/schema/1.0/spring-ws-test http://javacrumbs.net/schema/1.0/spring-ws-test.xsd
                http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd&quot;&gt;

        &lt;swst:mock-ws-message-sender&gt;
                &lt;swst:namespaces&gt;
                        &lt;entry key=&quot;ns&quot; value=&quot;http://www.springframework.org/spring-ws/samples/airline/schemas/messages&quot;/&gt;
                &lt;/swst:namespaces&gt;
                &lt;swst:resource-config&gt;
                        &lt;swst:discriminators&gt;
                                &lt;entry key=&quot;GetFlightsRequest&quot; value=&quot;//ns:from;//ns:to&quot;/&gt;
                        &lt;/swst:discriminators&gt;          
                &lt;/swst:resource-config&gt;
                &lt;swst:schemas&gt;
                                xsd/messages.xsd
                                xsd/types.xsd
                &lt;/swst:schemas&gt;
        &lt;/swst:mock-ws-message-sender&gt;
&lt;/beans&gt;</pre></div><p>When this configuration will be loaded by Spring a mock message sender will be created and automatically injected into the <a class="externalLink" href="http://static.springsource.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/client/core/WebServiceTemplate.html">WebServiceTemplate</a>. Default <a class="externalLink" href="http://static.springsource.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/transport/WebServiceMessageSender.html">WebServiceMessageSender</a> will be replaced by the mock. Please note that WebServiceTemplate is not defined here, you probably have it already defined in another configuration file. </p></div><div class="section"><h3>Test<a name="Test"></a></h3><p>When you have the configuration and mock response, you can start writing the test. The only thing you need to do is to load &quot;dummy-message-sender.xml&quot; together with the rest of your Spring configuration files.</p></div><div class="section"><h3>Validation<a name="Validation"></a></h3><p>If you want to validate your request you can either define schemas or it is also possible to compare request with predefined templates. The only thing you have to do is to create file &quot;PRG-DUB-request.xml&quot; in the same directory and the request will be automatically compared to the content of the file. </p></div><div class="section"><h3>Templates<a name="Templates"></a></h3><p>It is also possible to use XSLT templates for both response generation and request validation. Please consult <a href="#reference.html">reference</a> for more details. </p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2013.
          All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
